/**
* @author Jason Dobry <jason.dobry@gmail.com>
* @file angular-data-localForage.min.js
* @version 1.0.0 - Homepage <https://github.com/jmdobry/angular-data-localForage/>
* @copyright (c) 2014 Jason Dobry <https://github.com/jmdobry/>
* @license MIT <https://github.com/jmdobry/angular-data-localForage/blob/master/LICENSE>
*
* @overview localForage adapter for angular-data.
*/
!function(a){if("object"==typeof exports&&"undefined"!=typeof module)module.exports=a();else if("function"==typeof define&&define.amd)define([],a);else{var b;"undefined"!=typeof window?b=window:"undefined"!=typeof global?b=global:"undefined"!=typeof self&&(b=self),b.DSLocalForageAdapter=a()}}(function(){return function a(b,c,d){function e(g,h){if(!c[g]){if(!b[g]){var i="function"==typeof require&&require;if(!h&&i)return i(g,!0);if(f)return f(g,!0);var j=new Error("Cannot find module '"+g+"'");throw j.code="MODULE_NOT_FOUND",j}var k=c[g]={exports:{}};b[g][0].call(k.exports,function(a){var c=b[g][1][a];return e(c?c:a)},k,k.exports,a,b,c,d)}return c[g].exports}for(var f="function"==typeof require&&require,g=0;g<d.length;g++)e(d[g]);return e}({1:[function(a,b){var c=a("./isKind"),d=Array.isArray||function(a){return c(a,"Array")};b.exports=d},{"./isKind":2}],2:[function(a,b){function c(a,b){return d(a)===b}var d=a("./kindOf");b.exports=c},{"./kindOf":3}],3:[function(a,b){function c(a){return null===a?"Null":a===d?"Undefined":e.exec(f.call(a))[1]}var d,e=/^\[object (.*)\]$/,f=Object.prototype.toString;b.exports=c},{}],4:[function(a,b){b.exports=2147483647},{}],5:[function(a,b){b.exports=-2147483648},{}],6:[function(a,b){function c(a){var b=1===arguments.length&&e(a)?a:arguments;return b[d(0,b.length-1)]}var d=a("./randInt"),e=a("../lang/isArray");b.exports=c},{"../lang/isArray":1,"./randInt":10}],7:[function(a,b){function c(){return d(8)+"-"+d(4)+"-4"+d(3)+"-"+e(8,9,"a","b")+d(3)+"-"+d(12)}var d=a("./randHex"),e=a("./choice");b.exports=c},{"./choice":6,"./randHex":9}],8:[function(a,b){function c(a,b){return a=null==a?e:a,b=null==b?f:b,a+(b-a)*d()}var d=a("./random"),e=a("../number/MIN_INT"),f=a("../number/MAX_INT");b.exports=c},{"../number/MAX_INT":4,"../number/MIN_INT":5,"./random":11}],9:[function(a,b){function c(a){a=a&&a>0?a:6;for(var b="";a--;)b+=d(e);return b}var d=a("./choice"),e="0123456789abcdef".split("");b.exports=c},{"./choice":6}],10:[function(a,b){function c(a,b){return a=null==a?d:~~a,b=null==b?e:~~b,Math.round(f(a-.5,b+.499999999999))}var d=a("../number/MIN_INT"),e=a("../number/MAX_INT"),f=a("./rand");b.exports=c},{"../number/MAX_INT":4,"../number/MIN_INT":5,"./rand":8}],11:[function(a,b){function c(){return c.get()}c.get=Math.random,b.exports=c},{}],12:[function(a){var b=a("mout/random/guid");!function(a,c,d){"use strict";function e(){this.$get=["DSUtils","$q","DS","$rootScope",function(a,c,e,f){function g(a,b){return f.$$phase?a.resolve(b):f.$apply(function(){return a.resolve(b)})}function h(a,b){return f.$$phase?a.reject(b):f.$apply(function(){return a.reject(b)})}return{getPath:function(b,c){return a.makePath(c.baseUrl||b.baseUrl,b.name)},getIdPath:function(b,c,d){return a.makePath(c.baseUrl||b.baseUrl,b.getEndpoint(d,c),d)},getIds:function(a,b){var e=this.getPath(a,b),f=c.defer();return d.getItem(e,function(a,b){return a?h(f,a):b?g(f,b):d.setItem(e,{},function(a,b){a?h(f,a):g(f,b)})}),f.promise},saveKeys:function(a,b,e){var f=this.getPath(b,e),i=c.defer();return d.setItem(f,a,function(a,b){a?h(i,a):g(i,b)}),i.promise},ensureId:function(a,b,c){var d=this;return d.getIds(b,c).then(function(e){return e[a]=1,d.saveKeys(e,b,c)})},removeId:function(a,b,c){var d=this;return d.getIds(b,c).then(function(e){return delete e[a],d.saveKeys(e,b,c)})},GET:function(a){var b=c.defer();return d.getItem(a,function(a,c){a?h(b,a):g(b,c)}),b.promise},PUT:function(a,b){var e=c.defer();return d.setItem(a,b,function(a,b){a?h(e,a):g(e,b)}),e.promise},DEL:function(a){var b=c.defer();return d.removeItem(a,function(a,c){return a?h(b,a):g(b,c)}),b.promise},find:function(a,b,d){return d=d||{},this.GET(this.getIdPath(a,d,b)).then(function(a){return a?a:c.reject(new Error("Not Found!"))})},findAll:function(b,d,f){var g=this;return f=f||{},g.getIds(b,f).then(function(d){var e=a.keys(d);"allowSimpleWhere"in f||(f.allowSimpleWhere=!0);var h=[];return a.forEach(e,function(a){h.push(g.GET(g.getIdPath(b,f,a)))}),c.all(h)}).then(function(a){return e.defaults.defaultFilter.call(e,a,b.name,d,f)})},create:function(c,d,e){var f,g=this;return d[c.idAttribute]=d[c.idAttribute]||b(),e=e||{},g.PUT(a.makePath(this.getIdPath(c,e,d[c.idAttribute])),d).then(function(a){return f=a,g.ensureId(a[c.idAttribute],c,e)}).then(function(){return f})},update:function(b,c,d,e){var f,g,h=this;e=e||{};var i=h.getIdPath(b,e,c);return h.GET(i).then(function(b){return b&&(g=b,a.deepMixIn(g,d)),h.PUT(i,g||d)}).then(function(){return f=g,h.ensureId(g[b.idAttribute],b,e)}).then(function(){return f})},updateAll:function(b,d,e,f){var g=this;return g.findAll(b,e,f).then(function(e){var h=[];return a.forEach(e,function(a){h.push(g.update(b,a[b.idAttribute],d,f))}),c.all(h)})},destroy:function(a,b,c){var d=this;return c=c||{},d.DEL(d.getIdPath(a,c,b)).then(function(){return d.removeId(b,a,c)}).then(function(){return null})},destroyAll:function(b,d,e){var f=this;return f.findAll(b,d,e).then(function(d){var g=[];return a.forEach(d,function(a){g.push(f.destroy(b,a[b.idAttribute],e))}),c.all(g)})}}}]}d.config({name:"DS"}),c.module("angular-data.DS").provider("DSLocalForageAdapter",e)}(window,window.angular,window.localforage)},{"mout/random/guid":7}]},{},[12])(12)});